<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>YouTube Video Downloader By Devil Creation</title>
  <style>
    :root {
      --bg-light: #DCDCDC;
      --text-light: #000;
      --shadow-light: darkblue;
      --btn-bg-light: #0078D7;
      --btn-hover-bg-light: #0000FF;
      --bg-dark: #121212;
      --text-dark: #EEE;
      --shadow-dark: #FF69B4;
      --btn-bg-dark: #bb86fc;
      --btn-hover-bg-dark: #3700b3;
    }

    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      border: 5px dashed black;
      background: var(--bg-light);
      color: var(--text-light);
      transition: background 0.3s, color 0.3s;
    }

    body.dark-mode {
      background: var(--bg-dark);
      color: var(--text-dark);
      border-color: #888;
    }

    h1 {
      font-size: 48px;
      color: var(--text-light);
      text-shadow: 3px 3px 6px var(--shadow-light);
      transition: text-shadow 0.3s, color 0.3s;
      cursor: default;
    }

    h1:hover {
      text-shadow: 3px 3px 6px var(--shadow-dark);
      color: var(--shadow-dark);
    }

    body.dark-mode h1 {
      color: var(--text-dark);
      text-shadow: 3px 3px 6px var(--shadow-dark);
    }

    input[type="url"] {
      padding: 10px;
      width: 80%;
      max-width: 400px;
      border-radius: 5px;
      border: 1px solid #888;
      font-size: 16px;
    }

    body.dark-mode input[type="url"] {
      background: #333;
      color: #eee;
      border-color: #555;
    }

    #urlInput.dragover {
      border-color: #00f;
      background-color: #eef;
    }

    button {
      padding: 10px 20px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      background: var(--btn-bg-light);
      color: white;
      cursor: pointer;
      font-size: 16px;
    }

    button:hover {
      background: var(--btn-hover-bg-light);
      border-radius: 10px;
    }

    body.dark-mode button {
      background: var(--btn-bg-dark);
    }

    body.dark-mode button:hover {
      background: var(--btn-hover-bg-dark);
    }

    .format-btn {
      display: block;
      margin: 5px auto;
      width: 90%;
      max-width: 300px;
      font-weight: bold;
    }

    img {
      max-width: 100%;
      height: auto;
      border: 5px solid black;
      margin: 10px 0;
    }

    img:hover {
      border: 10px solid rgba(0,0,0,0.5);
      box-shadow: 0 8px 16px rgba(0,0,0,0.4);
    }

    .section-title {
      margin-top: 20px;
      font-weight: bold;
    }

    #darkModeToggle, #i18nToggle {
      position: fixed;
      top: 10px;
      padding: 5px 10px;
      border: 2px solid currentColor;
      border-radius: 5px;
      background: transparent;
      cursor: pointer;
    }

    #darkModeToggle {
      right: 10px;
      border: 2px solid black;   
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
 }

    #i18nToggle {
      left: 10px;
      border: 2px solid black;    
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

    #spinner {
      border: 5px solid #f3f3f3;
      border-top: 5px solid #3498db;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      animation: spin 1s linear infinite;
      display: inline-block;
      vertical-align: middle;
    }

    #progressCircle {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(0, 0, 0, 0);
      border-top: 6px solid rgba(0, 0, 0, 0);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: none;
      margin-left: 8px;
      vertical-align: middle;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    #progress.success {
      color: green;
    }

    #progress.error {
      color: red;
    }

    .horror-effect {
      color: red !important;
      text-shadow: 0 0 5px red;
    }
  </style>
</head>
<body>
  <button id="darkModeToggle">üåô Dark Mode</button>
  <button id="i18nToggle">üåê ‡§π‡§ø‡§Ç‡§¶‡•Ä</button>

  <h1>YouTube Video Downloader</h1>

  <form id="urlForm">
    <input type="url" id="urlInput" placeholder="Enter YouTube URL..." required />
    <button type="submit" id="fetchBtn">Fetch Formats</button>
    <br>
    <span id="progress"></span>
    <span id="progressCircle"></span>
  </form>

  <div id="video-details" style="display:none;">
    <h3 id="video-title"></h3>
    <img id="video-thumb" src="" alt="Video Thumbnail" />
    <div class="section-title">Low Quality Video</div>
    <div id="video-audio"></div>
    <div class="section-title">High Quality Video</div>
    <button class="format-btn" id="high-quality-btn">Download High Quality Video</button>
    <div class="section-title">Video Only</div>
    <div id="video-only"></div>
    <div class="section-title">Audio Only</div>
    <div id="audio-only"></div>
    <div class="section-title">Download as MP3</div>
    <button class="format-btn" id="mp3-download-btn">Download MP3</button>
  </div>

  <script>
    const darkModeToggle = document.getElementById('darkModeToggle');
    const i18nToggle = document.getElementById('i18nToggle');
    const body = document.body;
    const form = document.getElementById('urlForm');
    const urlInput = document.getElementById('urlInput');
    const progressText = document.getElementById('progress');
    const progressCircle = document.getElementById('progressCircle');
    const fetchBtn = document.getElementById('fetchBtn');
    let lastURL = '';
    let currentLang = 'en';

    const textMap = {
      en: {
        title: "YouTube Video Downloader",
        placeholder: "Enter YouTube URL...",
        fetch: " Fetch Formats.....",
        error: "‚ùå Invalid YouTube URL!",
        success: "‚úîÔ∏è Formats fetched successfully!",
        somethingWrong: "‚ùå Something went wrong!",
        mp3: "Download MP3",
        highQuality: "Download High Quality Video"
      },
      hi: {
        title: "‡§Ø‡•Ç‡§ü‡•ç‡§Ø‡•Ç‡§¨ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°‡§∞",
        placeholder: "‡§Ø‡•Ç‡§ü‡•ç‡§Ø‡•Ç‡§¨ ‡§≤‡§ø‡§Ç‡§ï ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç...",
        fetch: " ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§≤‡§æ‡§è‡§Ç.....",
        error: "‚ùå ‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§Ø‡•Ç‡§ü‡•ç‡§Ø‡•Ç‡§¨ ‡§≤‡§ø‡§Ç‡§ï!",
        success: "‚úîÔ∏è ‡§´‡•â‡§∞‡•ç‡§Æ‡•á‡§ü ‡§Æ‡§ø‡§≤ ‡§ó‡§è!",
        somethingWrong: "‚ùå ‡§ï‡•Å‡§õ ‡§ó‡§≤‡§§ ‡§π‡•ã ‡§ó‡§Ø‡§æ!",
        mp3: "MP3 ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç",
        highQuality: "‡§â‡§ö‡•ç‡§ö ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç"
      }
    };

    function updateLanguage() {
      const lang = currentLang;
      document.querySelector("h1").textContent = textMap[lang].title;
      urlInput.placeholder = textMap[lang].placeholder;
      fetchBtn.textContent = textMap[lang].fetch;
      document.getElementById("mp3-download-btn").textContent = textMap[lang].mp3;
      document.getElementById("high-quality-btn").textContent = textMap[lang].highQuality;
      i18nToggle.textContent = lang === 'en' ? 'üåê ‡§π‡§ø‡§Ç‡§¶‡•Ä' : 'üåê English';
    }

    i18nToggle.onclick = () => {
      currentLang = currentLang === 'en' ? 'hi' : 'en';
      updateLanguage();
    };

    updateLanguage();

    if (localStorage.getItem('darkMode') === 'enabled') {
      body.classList.add('dark-mode');
      darkModeToggle.textContent = '‚òÄÔ∏è Light Mode';
    }

    darkModeToggle.onclick = () => {
      body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', body.classList.contains('dark-mode') ? 'enabled' : 'disabled');
      darkModeToggle.textContent = body.classList.contains('dark-mode') ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
    };

    urlInput.addEventListener('dragover', (e) => {
      e.preventDefault();
      urlInput.classList.add('dragover');
    });

    urlInput.addEventListener('dragleave', () => {
      urlInput.classList.remove('dragover');
    });

    urlInput.addEventListener('drop', (e) => {
      e.preventDefault();
      urlInput.classList.remove('dragover');
      const text = e.dataTransfer.getData('text');
      urlInput.value = text;
    });

    form.onsubmit = async (e) => {
      e.preventDefault();
      const url = urlInput.value.trim();
      const isValid = /^https?:\/\/(www\.)?youtube\.com\//.test(url);

      progressText.innerHTML = '<span id="spinner"></span> ' + textMap[currentLang].fetch;
      progressCircle.style.display = 'inline-block';
      progressText.className = '';
      fetchBtn.disabled = true;

      if (!isValid) {
        progressText.textContent = textMap[currentLang].error;
        progressText.className = 'error horror-effect';
        fetchBtn.disabled = false;
        progressCircle.style.display = 'none';
        return;
      }

      lastURL = url;
      try {
        const response = await fetch('/get_formats', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: new URLSearchParams({ url })
        });
        const data = await response.json();
        if (data.error) {
          progressText.textContent = "‚ùå " + data.error;
          progressText.className = 'error horror-effect';
        } else {
          progressText.textContent = textMap[currentLang].success;
          progressText.className = 'success';
          document.getElementById('video-title').textContent = data.title;
          document.getElementById('video-thumb').src = data.thumbnail;
          document.getElementById('video-details').style.display = 'block';
          const fillFormats = (divId, formats) => {
            const div = document.getElementById(divId);
            div.innerHTML = '';
            formats.forEach(format => {
              const btn = document.createElement('button');
              btn.className = "format-btn";
              btn.textContent = format.label;
              btn.onclick = () => downloadVideo(url, format.format_id);
              div.appendChild(btn);
            });
          };
          fillFormats('video-audio', data.video_audio);
          fillFormats('video-only', data.video_only);
          fillFormats('audio-only', data.audio_only);
          urlInput.value = '';
        }
      } catch (error) {
        progressText.textContent = textMap[currentLang].somethingWrong;
        progressText.className = 'error horror-effect';
        console.error(error);
      }

      progressCircle.style.display = 'none';
      fetchBtn.disabled = false;
    };

    function downloadVideo(url, format_id) {
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = '/download';
      form.innerHTML = `<input type="hidden" name="url" value="${url}">`
                      + `<input type="hidden" name="format_id" value="${format_id}">`;
      document.body.appendChild(form);
      form.submit();
      form.remove();
    }

    document.getElementById('high-quality-btn').onclick = () => {
      if (!lastURL) return alert('Please enter a valid URL first.');
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = '/download_high_quality';
      form.innerHTML = `<input type="hidden" name="url" value="${lastURL}">`;
      document.body.appendChild(form);
      form.submit();
      form.remove();
    };

    document.getElementById('mp3-download-btn').onclick = () => {
      if (!lastURL) return alert('Please enter a valid URL first.');
      const form = document.createElement('form');
      form.method = 'POST';
      form.action = '/download_mp3';
      form.innerHTML = `<input type="hidden" name="url" value="${lastURL}">`;
      document.body.appendChild(form);
      form.submit();
      form.remove();
    };
  </script>
</body>
</html>
